sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,r,o){"use strict";return e.extend("com.general.nitin.controller.App",{onInit:function(){this.getView().setModel(new t({itemSelected:false,selectedQuantity:1}),"userSelection")},onSelect:function(e){let t=this.getView().getModel("userSelection");let r=e.getSource().getBindingContext().sPath;let o=e.getSource().getModel().getProperty(r);t.setProperty("/selectedItemPath",r);t.setProperty("/selectedItemData",o);t.setProperty("/selectedQuantity",1);this.getView().byId("orderStatus").setText("");t.setProperty("/itemSelected",true)},onSubmitOrder:function(){let e=this.getView();let t=e.getModel("userSelection").getData();let r={url:"/browse/submitOrder",method:"POST",timeout:0,headers:{"Content-Type":"application/json"},data:JSON.stringify({book:t.selectedItemData.ID,quantity:t.selectedQuantity})};let o=e.getModel("i18n");jQuery.ajax(r).done(function(r){console.log(r);e.byId("orderStatus").setText(`${o.getProperty("orderSuccessful")} \n                            (${t.selectedItemData.title}, \n                            ${t.selectedQuantity} \n                            ${o.getProperty("pieces")})`);e.byId("orderStatus").setState("Success");let s=e.getModel("userSelection").getProperty("/selectedItemPath");e.getModel().setProperty(s+"/stock",r.stock);e.getModel("userSelection").setProperty("/selectedItemData/stock",r.stock)}).fail(function(t){console.log(t);e.byId("orderStatus").setText(`${o.getProperty("Error")}`);e.byId("orderStatus").setState("Error")})},onSearch:function(e){var t=[];var s=e.getParameter("newValue");if(s){t.push(new r("title",o.Contains,s))}var i=this.byId("booksTable");var l=i.getBinding("items");l.filter(t);let n=this.getView().getModel("userSelection");n.setProperty("/selectedItemPath",{});n.setProperty("/selectedItemData",{});this.getView().byId("orderStatus").setText("");n.setProperty("/itemSelected",false)}})});